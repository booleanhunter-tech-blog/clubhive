CREATE DATABASE clubhive;

CREATE TABLE topics (
    id BIGINT GENERATED BY default AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    description VARCHAR(500)
);

CREATE TABLE users (
    id BIGINT GENERATED BY default AS IDENTITY PRIMARY KEY,
    username VARCHAR(50) NOT NULL UNIQUE,
    email VARCHAR(50) NOT NULL UNIQUE,
    name VARCHAR(100),
    bio VARCHAR(350),
    join_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE clubs (
    id BIGINT GENERATED BY default AS IDENTITY PRIMARY KEY,
    founder_id BIGINT NOT NULL references users(id),
    name VARCHAR(100) NOT NULL,
    topic_id BIGINT NOT NULL,
    date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (topic_id) REFERENCES topics(id)
);

CREATE TABLE rooms (
    id BIGINT GENERATED BY default AS IDENTITY PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    club_id BIGINT references clubs(id) ON UPDATE CASCADE ON DELETE CASCADE,
    date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE followers (
    club_id BIGINT REFERENCES clubs(id) NOT NULL,
    user_id BIGINT REFERENCES users(id) NOT NULL,
    UNIQUE(club_id, user_id),
    PRIMARY KEY (club_id, user_id),
    FOREIGN KEY (club_id) REFERENCES clubs(id) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE participants (
    room_id BIGINT REFERENCES rooms(id) NOT NULL,
    user_id BIGINT REFERENCES users(id) NOT NULL,
    role VARCHAR(10) DEFAULT 'AUDIENCE' NOT NULL CHECK(role IN ('HOST', 'MODERATOR', 'SPEAKER', 'AUDIENCE')),
    join_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    peer_id VARCHAR(50),
    UNIQUE(room_id, user_id),
    PRIMARY KEY (room_id, user_id),
    FOREIGN KEY (room_id) REFERENCES rooms(id) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (user_id) REFERENCES users(id) ON UPDATE CASCADE ON DELETE CASCADE
);

INSERT INTO topics (id, name) VALUES (1, 'Health');
INSERT INTO topics (id, name) VALUES (2, 'Science');
INSERT INTO topics (id, name) VALUES (3, 'Geopolitics');
INSERT INTO topics (id, name) VALUES (4, 'Entertainment');
INSERT INTO topics (id, name) VALUES (5, 'Technology');


INSERT INTO users (id, username, email, name, bio) VALUES (1, 'ashwin', 'ashwin01h@gmail.com', 'Ashwin Hariharan', 'Teacher on occasions, student for life | Science Nerd & fitness enthusiast');
INSERT INTO users (id, username, email, name, bio) VALUES (2, 'purnima', 'dhammapurnima@gmail.com', 'Purnima Gupta', 'Web Dev Diva. I''ve mastered the seflie - now on a journey to master thy self.');
INSERT INTO users (id, username, email, name, bio) VALUES (3, 'raghu', 'rpotini@egen.solutions', 'Raghu Potini', 'Founder at Egen');
INSERT INTO users (id, username, email, name, bio) VALUES (4, 'kavita', 'kavita.mistry@egen.solutions', 'Kavita Mistry', 'Lead generation specialist at Egen');
INSERT INTO users (id, username, email, name, bio) VALUES (5, 'elon', 'elonmuskoffice@teslamotors.com', 'Elon Musk', 'Founder at Tesla and SpaceX. I would like to die on Mars. Just not on impact.');
INSERT INTO users (id, username, email, name, bio) VALUES (6, 'john', 'johnwick@continental.com', 'John Wick', 'Baba Yaga. Excommunicado. Former member of The High Table');
INSERT INTO users (id, username, email, name, bio) VALUES (7, 'rick', 'ricksanchez@c-137.earth', 'Rick Sanchez', 'Scientist. Existential Nihilist. To live is to risk it all; otherwise you''re just an inert chunk of randomly assembled molecules drifting wherever the universe blows you');
INSERT INTO users (id, username, email, name, bio) VALUES (8, 'loki', 'loki@marvel.com', 'Loki Laufeyson', 'God of Mischief. Enjoys torturing my brother');
INSERT INTO users (id, username, email, name, bio) VALUES (9, 'cj', 'carljohnson@gtasanandreas.com', 'Carl Johnson', 'Lives in Los Santos. Frequently gets into car chases.');
INSERT INTO users (id, username, email, name, bio) VALUES (10, 'sarah', 'sarahconnor@destroyskynet.com', 'Sarah Connor', 'Time Traveller. Terminator of terminators.');

INSERT INTO clubs (id, founder_id, name, topic_id) VALUES (1, 6, 'Fit as a Fiddle', 1);
INSERT INTO clubs (id, founder_id, name, topic_id) VALUES (2, 7, 'The Council of Ricks', 2);
INSERT INTO clubs (id, founder_id, name, topic_id) VALUES (3, 8, 'World Governments', 3);
INSERT INTO clubs (id, founder_id, name, topic_id) VALUES (4, 9, 'Video Games', 4);
INSERT INTO clubs (id, founder_id, name, topic_id) VALUES (5, 10, 'Hail our AI Overlords', 5);


INSERT INTO rooms (id, club_id, name) VALUES (1, 1, 'Achieving impossible tasks');
INSERT INTO rooms (id, club_id, name) VALUES (3, 2, 'Sometimes science is more art than science.');
INSERT INTO rooms (id, club_id, name) VALUES (5, 3, 'Asgard vs Wakanda');
INSERT INTO rooms (id, club_id, name) VALUES (7, 4, 'Are video games bad for you?');
INSERT INTO rooms (id, club_id, name) VALUES (9, 5, 'How to de-activate a robot');
INSERT INTO rooms (id, club_id, name) VALUES (11, 5, 'Github Copilot - Good or Bad?');

INSERT INTO rooms (id, club_id, name) VALUES (2, 1, 'Strength Training for MMA');
INSERT INTO rooms (id, club_id, name) VALUES (4, 2, 'Love is just a chemical reaction');
INSERT INTO rooms (id, club_id, name) VALUES (6, 3, 'Democracy in India - Success or Failure?');
INSERT INTO rooms (id, club_id, name) VALUES (8, 4, 'Far Cry 6 - reviews');
INSERT INTO rooms (id, club_id, name) VALUES (10, 5, 'The Industries of the future');
INSERT INTO rooms (id, name) VALUES (12, 'What club shall we create');


INSERT INTO followers (club_id, user_id) VALUES (1, 1);
INSERT INTO followers (club_id, user_id) VALUES (2, 1);
INSERT INTO followers (club_id, user_id) VALUES (3, 1);
INSERT INTO followers (club_id, user_id) VALUES (4, 1);
INSERT INTO followers (club_id, user_id) VALUES (5, 1);

INSERT INTO followers (club_id, user_id) VALUES (1, 2);
INSERT INTO followers (club_id, user_id) VALUES (2, 2);
INSERT INTO followers (club_id, user_id) VALUES (5, 2);

INSERT INTO followers (club_id, user_id) VALUES (1, 3);
INSERT INTO followers (club_id, user_id) VALUES (2, 3);
INSERT INTO followers (club_id, user_id) VALUES (3, 3);
INSERT INTO followers (club_id, user_id) VALUES (4, 3);
INSERT INTO followers (club_id, user_id) VALUES (5, 3);

INSERT INTO followers (club_id, user_id) VALUES (3, 4);
INSERT INTO followers (club_id, user_id) VALUES (5, 4);

INSERT INTO followers (club_id, user_id) VALUES (3, 5);
INSERT INTO followers (club_id, user_id) VALUES (4, 5);
INSERT INTO followers (club_id, user_id) VALUES (5, 5);

INSERT INTO followers (club_id, user_id) VALUES (1, 6);
INSERT INTO followers (club_id, user_id) VALUES (3, 6);
INSERT INTO followers (club_id, user_id) VALUES (4, 6);

INSERT INTO followers (club_id, user_id) VALUES (2, 7);
INSERT INTO followers (club_id, user_id) VALUES (3, 7);
INSERT INTO followers (club_id, user_id) VALUES (5, 7);

INSERT INTO followers (club_id, user_id) VALUES (1, 8);
INSERT INTO followers (club_id, user_id) VALUES (3, 8);
INSERT INTO followers (club_id, user_id) VALUES (5, 8);

INSERT INTO followers (club_id, user_id) VALUES (1, 9);
INSERT INTO followers (club_id, user_id) VALUES (3, 9);
INSERT INTO followers (club_id, user_id) VALUES (4, 9);

INSERT INTO followers (club_id, user_id) VALUES (1, 10);
INSERT INTO followers (club_id, user_id) VALUES (3, 10);
INSERT INTO followers (club_id, user_id) VALUES (5, 10);


INSERT INTO participants (room_id, user_id, role) VALUES (1, 6, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (2, 6, 'HOST');

INSERT INTO participants (room_id, user_id, role) VALUES (3, 7, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (4, 7, 'HOST');

INSERT INTO participants (room_id, user_id, role) VALUES (5, 8, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (6, 8, 'HOST');

INSERT INTO participants (room_id, user_id, role) VALUES (7, 9, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (8, 9, 'HOST');

INSERT INTO participants (room_id, user_id, role) VALUES (9, 10, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (10, 10, 'HOST');

INSERT INTO participants (room_id, user_id, role) VALUES (11, 1, 'HOST');
INSERT INTO participants (room_id, user_id, role) VALUES (12, 3, 'HOST');